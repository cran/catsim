<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Two-Dimensional Examples of CatSIM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Two-Dimensional Examples of CatSIM</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(catsim)</span></code></pre></div>
<div id="introduction-to-catsim" class="section level2">
<h2>Introduction to CatSIM</h2>
<p>The <strong>Cat</strong>egorical <strong>S</strong>tructural
Similarity <strong>I</strong>mage <strong>M</strong>etric, or
<strong>CatSIM</strong>, provides a similarity metric for binary or
multinary images or maps after the style of <a href="https://en.wikipedia.org/wiki/Structural_similarity">MS-SSIM</a>.
That is, CatSIM compares two different sets of labels of pixels (voxels)
in 2-D (or 3-D) images in an image. It attempts to assess similarity
between two images in a way that accounts for the structural features of
the image rather than a per-pixel discrepancy, ideally doing so
similarly to human assessments of similarity. The package implements the
methods described in <span class="citation">(<strong>thompson2020catsim?</strong>)</span>.</p>
</div>
<div id="how-catsim-works" class="section level2">
<h2>How CatSIM works</h2>
<p>CatSIM computes a set of similarity metrics on a sliding window in
the images, then averages and combines them. In then downsamples the
images and repeats the process. Finally, it combines the measures from
the different levels together. It can use a variety of different
similarity metrics inside of it depending on the specific meaning of the
labels in the image. By default, it uses <a href="https://en.wikipedia.org/wiki/Cohen%27s_kappa">Cohen’s kappa</a>
inside it as its main comparison between the two images. However, there
are several other options available which are more appropriate in some
contexts.</p>
</div>
<div id="constructing-a-binary-illustration" class="section level2">
<h2>Constructing a binary illustration</h2>
<p>Besag <span class="citation">(1986)</span> presents a <span class="math inline">\(100 \times 88\)</span> two-dimensional two-class
image with “intentionally awkward” features. Here we blow it up to three
times its size and create two distorted versions to demonstrate how the
method works.</p>
<p>The first distorted version is shifting the body of the figure over 6
pixels. The second distorted version is adding salt-and-pepper noise so
the error rate matches the difference between original and the shifted
version.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20200308</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>multfactor <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>onesmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, multfactor, multfactor)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>exmat <span class="ot">&lt;-</span> (besag <span class="sc">%%</span> <span class="dv">2</span>) <span class="do">### converting to binary - it&#39;s ones and twos</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>bigmat <span class="ot">&lt;-</span> exmat <span class="sc">%x%</span> onesmat</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>bigmat <span class="ot">&lt;-</span> exmat <span class="sc">%x%</span> onesmat</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>shift <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>basemat <span class="ot">&lt;-</span> bigmat[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">96</span> <span class="sc">*</span> multfactor), <span class="dv">1</span><span class="sc">:</span>(<span class="dv">84</span> <span class="sc">*</span> multfactor)]</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>shiftmat <span class="ot">&lt;-</span> bigmat[(<span class="dv">1</span> <span class="sc">+</span> shift)<span class="sc">:</span>(<span class="dv">96</span> <span class="sc">*</span> multfactor <span class="sc">+</span> shift), <span class="dv">1</span><span class="sc">:</span>(<span class="dv">84</span> <span class="sc">*</span> multfactor)]</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>acc <span class="ot">&lt;-</span> <span class="fu">mean</span>(basemat <span class="sc">==</span> shiftmat)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>errmat <span class="ot">&lt;-</span> (<span class="fu">matrix</span>(</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">96</span> <span class="sc">*</span> <span class="dv">84</span> <span class="sc">*</span> (multfactor<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(acc, ((<span class="dv">1</span> <span class="sc">-</span> acc)))</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  ),</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  (<span class="dv">96</span> <span class="sc">*</span> multfactor), (<span class="dv">84</span> <span class="sc">*</span> multfactor)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>) <span class="sc">+</span> basemat) <span class="sc">%%</span> <span class="dv">2</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">image</span>(basemat, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>); <span class="fu">grid</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="fu">image</span>(shiftmat, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>); <span class="fu">grid</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="fu">image</span>(errmat, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>); <span class="fu">grid</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we have the original, the shifted version, and the
salt-and-pepper noise. We argue that though the proportion of pixels
that differ from the base image are approximately the same for the two,
an image similarity metric should say the shift is better.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.5648881</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.4614073</span></span></code></pre></div>
<p>As we might desire, the <code>catsim</code> metric judges the shift
to be more like the original than the salt-and-pepper noise.</p>
<p>Because this is a two-class image, you can consider using the Jaccard
index as the metric inside it with similar results:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">method =</span> <span class="st">&quot;Jaccard&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.5647088</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat, <span class="at">method =</span> <span class="st">&quot;Jaccard&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.52999</span></span></code></pre></div>
</div>
<div id="constructing-a-multiclass-example" class="section level2">
<h2>Constructing a multiclass example</h2>
<p>To demonstrate how it works, first we construct a simple
multicategory image and blow it up to a larger size. The grid lines are
added for reference. This is our “ground truth” image.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>multfactor <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>onesmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, multfactor, multfactor)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>exmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">12</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>exmat[<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>exmat[<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>)] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>exmat[<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>exmat[<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="dv">6</span>)] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">par</span>( <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">image</span>(exmat[<span class="dv">11</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>], <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>bigmat <span class="ot">&lt;-</span> exmat <span class="sc">%x%</span> onesmat</span></code></pre></div>
<p>Next, we construct two distorted versions. The first simply shifts
the central portion of the image over six pixels. Then, we compute the
percentage of pixels that disagree with the baseline image and create a
second distorted image by adding salt-and-pepper noise at that rate.
Again, grid lines are added only for reference.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20200323</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>shift  <span class="ot">&lt;-</span>  <span class="dv">6</span> <span class="co"># we are shifting horizontally by six pixels</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>basemat <span class="ot">&lt;-</span> bigmat[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">11</span> <span class="sc">*</span> multfactor), <span class="dv">1</span><span class="sc">:</span>(<span class="dv">11</span> <span class="sc">*</span> multfactor)]</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>shiftmat <span class="ot">&lt;-</span> bigmat[(<span class="dv">1</span> <span class="sc">+</span> shift) <span class="sc">:</span> (<span class="dv">11</span> <span class="sc">*</span> multfactor <span class="sc">+</span> shift), <span class="dv">1</span><span class="sc">:</span> (<span class="dv">11</span> <span class="sc">*</span> multfactor)]</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">### Here we have shifted the matrix slightly</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">image</span>(shiftmat, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="do">### computing the error rate</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>acc  <span class="ot">&lt;-</span>  <span class="fu">mean</span>(basemat <span class="sc">==</span> shiftmat)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>errmat <span class="ot">&lt;-</span> (<span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">121</span> <span class="sc">*</span> (multfactor<span class="sc">^</span><span class="dv">2</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>                         <span class="at">prob =</span> <span class="fu">c</span>(acc, <span class="fu">rep</span>((<span class="dv">1</span> <span class="sc">-</span> acc) <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>))),</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                        (<span class="dv">11</span> <span class="sc">*</span> multfactor), (<span class="dv">11</span> <span class="sc">*</span> multfactor)) <span class="sc">+</span> basemat) <span class="sc">%%</span> <span class="dv">4</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">### here we have made an image that matches its accuracy with salt and pepper noise</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">image</span>(errmat, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Depending on your preferences, you may have reason to prefer one or
the other, but, arguably, the shifted version is in some sense better,
even though their pixelwise agreement is approximately the same.</p>
</div>
<div id="computing-image-similarity" class="section level2">
<h2>Computing Image Similarity</h2>
<p>If we take only one level of <code>catsim</code>, we get the
following results when comparing to the initial matrix:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(catsim)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="do">### comparing base to shifted</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.6860161</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">### comparing base to salt-and-pepper</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat, <span class="at">weights =</span> <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; [1] 0.105825</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="do">### looking at accuracy</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">mean</span>(basemat <span class="sc">==</span> shiftmat)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.9355372</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">mean</span>(basemat <span class="sc">==</span> errmat)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; [1] 0.9364463</span></span></code></pre></div>
<p>This captures the similarity between the original image and the
shifted image, but is too “critical” of the salt-and-pepper error. We
can correct this by looking at the image on multiple scales: we
downsample by a factor of 2 and then compute the index for that layer,
then repeat, and combine the layers at the end into one measure. By
default, we use 5 layers of downsampling, but this can be specified
based on your application and the size of the image. Downsampling should
remove and smooth out a light level of salt-and-pepper error.</p>
<p>With five levels, the difference is smaller, but still prefers the
shifted version over the salt and pepper error.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(.<span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.7525661</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">### comparing base to salt-and-pepper</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat, <span class="at">weights =</span> <span class="fu">rep</span>(.<span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.5724128</span></span></code></pre></div>
</div>
<div id="catsim-options" class="section level2">
<h2>CatSIM options</h2>
<p>By default, CatSIM uses <a href="https://en.wikipedia.org/wiki/Cohen&#39;s_kappa">Cohen’s kappa
(<span class="math inline">\(\kappa\)</span>)</a> as the similarity
comparison for the images. This measures agreement between the classes
with and adjustment for the probability of chance agreement. However,
depending on the application, a different comparison might make sense.
The following options are available (using the <code>method</code>
argument):</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard
index</a>, suitable for binary images where presence of one class is
important (for instance, fMRI activation maps), with
<code>method=&quot;Jaccard&quot;</code>.</li>
<li><a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient">Dice
index</a>, which is similar to the Jaccard index, with
<code>method=&quot;Dice&quot;</code>.</li>
<li><a href="https://en.wikipedia.org/wiki/Rand_index">Rand index</a>, a
similarity metric for comparing clusterings based on whether pairs of
points are in the same group, with <code>method=&quot;Rand&quot;</code>.</li>
<li><a href="https://en.wikipedia.org/wiki/Rand_index#Adjusted_Rand_index">Adjusted
Rand index</a>, a modification of the Rand index which corrects for the
probability of chance agreements, with <code>method =&quot;AdjRand&quot;</code> or
<code>ARI</code>.</li>
<li>Accuracy, or pixel-wise agreement, which is simply
<code>(# pixels agreeing)/(# pixels)</code>, with
<code>method=&quot;accuracy&quot;</code>.</li>
<li><a href="https://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-clustering-1.html">Normalized
mutual information</a>, a information theory similarity metric based on
the Kullback-Liebler divergence between the two distributions, with
<code>method = &quot;NMI&quot;</code> or <code>MI</code>.</li>
<li><a href="https://en.wikipedia.org/wiki/Adjusted_mutual_information">Adjusted
mutual information</a>, a correction to the mutual information to
account for the probability of chance agreements, with
<code>method = &quot;AMI&quot;</code>.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(.<span class="dv">5</span>,<span class="dv">2</span>), <span class="at">method=</span><span class="st">&quot;Rand&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.7972214</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(.<span class="dv">5</span>,<span class="dv">2</span>), <span class="at">method=</span><span class="st">&quot;NMI&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.2701349</span></span></code></pre></div>
<p>The window size can also be adjusted. It should be large enough to
capture the scale of the features that are relevant in the analysis. In
this example, a portion of the image was displaced by 6 pixels. Too
large of a window may average out that difference too much while too
small may miss the similarity between the images. Here is a comparison
between the shifted image and the salt-and-pepper noise at different
window sizes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">window =</span> <span class="dv">20</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.7878624</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">window =</span> <span class="dv">5</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.7424498</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat, <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">window =</span> <span class="dv">20</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.6766773</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">catsim</span>(basemat, errmat, <span class="at">weights =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">window =</span> <span class="dv">5</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; [1] 0.441829</span></span></code></pre></div>
<p>The number of levels CatSIM uses can be set by specifying either the
<code>levels</code> argument or passing a vector to
<code>weights</code>, where the length of the vector dictates how many
levels of downsampling will be performed. By default, if the number of
levels are specified without specifying the weights, the weights are set
to be equal across levels and add up to 1. Specifying
<code>weights = rep(1/3,3)</code> is the same as specifying
<code>levels = 3</code>.</p>
</div>
<div id="advanced-functionality" class="section level2">
<h2>Advanced Functionality</h2>
<p>The <code>catsim()</code> function works for both 2-D and 3-D images.
It is a wrapper for other functions which give more control over the
various options. On a 2-D image, it is calling
<code>catmssim_2d()</code> and on a 3-D image it is calling either
<code>catmssim_3d_cube()</code> or <code>catmssim_3d_slice()</code>,
which treats the image as either an isotropic 3-D image or a stack of
2-D slices.</p>
<p>In images with different properties across dimensions, the sliding
window used to assess the similarity might not need to be square. This
can be specified by passing a vector to the <code>window</code>
argument. In the provided examples, this is not necessary, but some
sources of images may not be isotropic. Alternatively, the image may be
elongated in one direction and narrow in another. This makes it possible
to accommodate these differences.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">catsim</span>(basemat, shiftmat, <span class="at">weights =</span> <span class="fu">rep</span>(.<span class="dv">2</span>, <span class="dv">5</span>), <span class="at">window =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.7299104</span></span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-besag1986statistical" class="csl-entry">
Besag, Julian. 1986. <span>“On the Statistical Analysis of Dirty
Pictures.”</span> <em>Journal of the Royal Statistical Society: Series B
(Methodological)</em> 48 (3): 259–79. <a href="https://doi.org/10.1111/j.2517-6161.1986.tb01412.x">https://doi.org/10.1111/j.2517-6161.1986.tb01412.x</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
